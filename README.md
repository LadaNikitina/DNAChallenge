# DNA Challenge

## üìö –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å **–≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏) –î–ù–ö-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π**, –∏ –∑–∞—Ç–µ–º –æ–±—É—á–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ 5 –±–∏–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á–∞—Ö** –∏–∑ –±–µ–Ω—á–º–∞—Ä–∫–∞ [Nucleotide Transformer Benchmark](https://huggingface.co/datasets/InstaDeepAI/nucleotide_transformer_downstream_tasks).

---

## üß™ –î–∞—Ç–∞—Å–µ—Ç—ã –∏ –º–µ—Ç—Ä–∏–∫–∏

–í—ã –±—É–¥–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—è—Ç—å—é –ø–æ–¥–∑–∞–¥–∞—á–∞–º–∏ –∏–∑ –±–µ–Ω—á–º–∞—Ä–∫–∞. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ —É–∫–∞–∑–∞–Ω–∞ **–æ—Å–Ω–æ–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞**, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏:

---

## üß¨ –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª –∑–∞–¥–∞—á

| ‚Ññ  | –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏      | –ú–µ—Ç—Ä–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏ | –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
|----|----------------------|----------------|-------------------------|
| 1  | **promoter_all**     | F1-score       | **–ü—Ä–æ–º–æ—Ç–µ—Ä—ã** ‚Äî —É—á–∞—Å—Ç–∫–∏ –î–ù–ö, —Å –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –≥–µ–Ω–∞. –≠—Ç–∏ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≥–µ–Ω–∞ –∏ —Å–ª—É–∂–∞—Ç —è–∫–æ—Ä–µ–º –¥–ª—è –†–ù–ö-–ø–æ–ª–∏–º–µ—Ä–∞–∑—ã. –ó–∞–¥–∞—á–∞ –≤–∞–∂–Ω–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–≥–æ, –∫–∞–∫–∏–µ —É—á–∞—Å—Ç–∫–∏ –≥–µ–Ω–æ–º–∞ –∞–∫—Ç–∏–≤–Ω–æ —ç–∫—Å–ø—Ä–µ—Å—Å–∏—Ä—É—é—Ç—Å—è. |
| 2  | **enhancers**        | MCC            | **–≠–Ω—Ö–∞–Ω—Å–µ—Ä—ã** ‚Äî —É—á–∞—Å—Ç–∫–∏ –î–ù–ö, —É—Å–∏–ª–∏–≤–∞—é—â–∏–µ —ç–∫—Å–ø—Ä–µ—Å—Å–∏—é –≥–µ–Ω–æ–≤. –û–Ω–∏ –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –¥–∞–ª–µ–∫–æ –æ—Ç —Å–∞–º–æ–≥–æ –≥–µ–Ω–∞ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –ø—Ä–æ–º–æ—Ç–µ—Ä–æ–º —á–µ—Ä–µ–∑ 3D-—Å–≤—ë—Ä—Ç–∫—É —Ö—Ä–æ–º–∞—Ç–∏–Ω–∞. –≠–Ω—Ö–∞–Ω—Å–µ—Ä—ã –∏–≥—Ä–∞—é—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ —Ç–∫–∞–Ω–µ—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π —ç–∫—Å–ø—Ä–µ—Å—Å–∏–∏. –ó–∞–¥–∞—á–∞ —Å–ª–æ–∂–Ω–∞—è –∏–∑-–∑–∞ –≤–∞—Ä–∏–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ —ç–Ω—Ö–∞–Ω—Å–µ—Ä–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. |
| 3  | **splice_sites_all** | Accuracy       | **Splice sites (—Å–∞–π—Ç—ã —Å–ø–ª–∞–π—Å–∏–Ω–≥–∞)** ‚Äî –≥—Ä–∞–Ω–∏—Ü—ã –º–µ–∂–¥—É —ç–∫–∑–æ–Ω–∞–º–∏ –∏ –∏–Ω—Ç—Ä–æ–Ω–∞–º–∏ –≤ –ø—Ä–µ-–º–†–ù–ö. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ç–∏—Ö —Å–∞–π—Ç–æ–≤ –≤–∞–∂–Ω–æ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π. –û—à–∏–±–∫–∏ –≤ —Å–ø–ª–∞–π—Å–∏–Ω–≥–µ —á–∞—Å—Ç–æ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º. –ó–∞–¥–∞—á–∞ ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –≥–¥–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —Å–ø–ª–∞–π—Å–∏–Ω–≥. |
| 4  | **H3**               | MCC            | –ú–µ—Ç–∫–∞ **H3 (–≥–∏—Å—Ç–æ–Ω H3, –Ω–∞–ø—Ä–∏–º–µ—Ä, H3K4me3)** —Å–≤—è–∑–∞–Ω–∞ —Å **–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø—Ä–æ–º–æ—Ç–µ—Ä–∞–º–∏** –∏ **—Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–º–∏ —Ä–µ–≥–∏–æ–Ω–∞–º–∏**. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ç–∞–∫–∏—Ö —ç–ø–∏–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–∫ –ø–æ –î–ù–ö-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ —Ä–µ–≥–∏–æ–Ω—ã –º–æ–≥—É—Ç –±—ã—Ç—å "–≤–∫–ª—é—á–µ–Ω—ã" –∏–ª–∏ "–≤—ã–∫–ª—é—á–µ–Ω—ã" –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ö—Ä–æ–º–∞—Ç–∏–Ω–∞. |
| 5  | **H4**               | MCC            | **H4** ‚Äî –µ—â—ë –æ–¥–∏–Ω –≥–∏—Å—Ç–æ–Ω, —É—á–∞—Å—Ç–≤—É—é—â–∏–π –≤ **—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω—É–∫–ª–µ–æ—Å–æ–º** –∏ —É–ø–∞–∫–æ–≤–∫–µ –î–ù–ö. –ï–≥–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–∞–∫–∂–µ –∏–≥—Ä–∞—é—Ç —Ä–æ–ª—å –≤ —Ä–µ–≥—É–ª—è—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏. –ó–∞–¥–∞—á–∞ ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—á–∞—Å—Ç–∫–∏ –î–ù–ö, –∫–æ—Ç–æ—Ä—ã–µ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —Å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º H4, —á—Ç–æ –¥–∞—ë—Ç –∫–ª—é—á –∫ –ø–æ–Ω–∏–º–∞–Ω–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ö—Ä–æ–º–∞—Ç–∏–Ω–∞. |

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ñ–æ—Ä–º—É–ª—ã –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏:

### 1. **F1-score (–≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ Precision –∏ Recall)**

F1-score –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–∞ –≤ –∑–∞–¥–∞—á–∞—Ö —Å–æ **—Å–∏–ª—å–Ω—ã–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤**.

$$
\text{F1} = \frac{2 \cdot \text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}, \quad \text{–≥–¥–µ:}
$$

$$
\text{Precision} = \frac{TP}{TP + FP}, \quad \text{Recall} = \frac{TP}{TP + FN}
$$

- **TP** ‚Äî –∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (True Positives)
- **FP** ‚Äî –ª–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (False Positives)
- **FN** ‚Äî –ª–æ–∂–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (False Negatives)

---

### 2. **MCC (Matthews Correlation Coefficient)**

MCC ‚Äî –º–µ—Ç—Ä–∏–∫–∞, –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–π –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–æ–≤. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç `-1` –¥–æ `1`:

$$
\text{MCC} = \frac{TP \cdot TN - FP \cdot FN}{\sqrt{(TP+FP)(TP+FN)(TN+FP)(TN+FN)}}
$$

- `1` ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ
- `0` ‚Äî —Å–ª—É—á–∞–π–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
- `-1` ‚Äî –ø–æ–ª–Ω–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ

---

### 3. **Accuracy (–¥–æ–ª—è –≤–µ—Ä–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤)**

$$
\text{Accuracy} = \frac{TP + TN}{TP + TN + FP + FN}
$$

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –∫–ª–∞—Å—Å—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã.

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### üì¶ –î–∞–Ω–Ω—ã–µ

–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ HuggingFace:

```python
from datasets import load_dataset

dataset = load_dataset("InstaDeepAI/nucleotide_transformer_downstream_tasks", "promoter_all")
```

–ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª—è:
- `"sequence"` ‚Äî —Å—Ç—Ä–æ–∫–∞ –∏–∑ —Å–∏–º–≤–æ–ª–æ–≤ {A, T, G, C}
- `"label"` ‚Äî —Ç–∞—Ä–≥–µ—Ç

---

### üß™ –ë–∞–∑–æ–≤–∞—è —Å—Ö–µ–º–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

1. üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
2. üß¨ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –≤–µ–∫—Ç–æ—Ä—ã (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏).
3. ü§ñ –û–±—É—á–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä.
4. üìä –ü–æ—Å—á–∏—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫—É –Ω–∞ test.

---

## üèÜ –ó–∞–¥–∞–Ω–∏–µ

–ü–æ—Å—Ç—Ä–æ–π—Ç–µ pipeline, –∫–æ—Ç–æ—Ä—ã–π –¥–∞—ë—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –Ω–∞ –≤—Å–µ—Ö 5 –∑–∞–¥–∞—á–∞—Ö**, –ø—Ä–∏–º–µ–Ω—è—è —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –î–ù–ö-—Ü–µ–ø–æ—á–µ–∫ –∏ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ò—Ç–æ–≥–æ–≤–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –≤—Å–µ—Ö 5 –º–µ—Ç—Ä–∏–∫.
